---
title: "Toronto's Uptick in Hate Crime: Time and Group Trends"
subtitle: "An Exploratory Analysis of Hate Crime in Toronto"
author: 
  - Justin Klip
thanks: "Code and data are available at: https://github.com/justinklip/hate_crime_toronto_paper."
date: today
date-format: long
abstract: "Using data from Open Data Toronto, this paper the tracks the evolution of hate crime in Toronto from 2018 to the end of 2023. The up tick of hate crime began during the start of COVID-19, remained at elevated levels since then, and has continued to rise in 2023 where there are now 3 times as many hate crime than in 2018. The data also shows that during the COVID period of 2020, 2021, and 2022, race and ethnicity made up much larger levels of the share of hate crimes in comparison to 2018, 2019 and 2023. Religion generally makes up the largest reason for hate crime, although in some COVID years it was tied with race. Other reasons such as sexual orientation, ethnicity, also are large victim groups. The most targetted religious group were Jewish people, whereas the most targetted race was Black people, although in 2021 East/Southeast Asian people made up a significant share of race related hate crimes as well."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(janitor)
library(dplyr)
library(ggplot2)
library(lubridate)
library(tinytex)
library(zoo)
library(tidyr)
library(opendatatoronto)
library(knitr)

#Data Acquisition
hate_crime_analysis_data <- read_csv(here::here("data/analysis_data/hate_crime_analysis_data.csv"))
```

# Introduction {#sec-introduction}

In 1988 the Canadian Parliament passed the Canadian Multiculturalism Act, an act that served to recognize and preserve Canada's multicultural heritage @government_of_canada_about_2024. Toronto serves as a shining example of Canada's multiculturalism, with over half of the population of Toronto being foreign-born [@mcneil_how_2023]. Yet, despite Toronto's reputation as an international city with large widespread cultural heterogeneity, hate crimes have seen an uptick in recent times. Hate crimes in Toronto have increased nearly 55% in 2024 in comparison to 2023. A hate crime is defined as a "criminal act done by a person who is motivated by an extreme bias or hatred towards a particular social group" [@government_of_canada_victims_2023]. Acts like these are fundamentally at odds with the sentiment expressed by the Canadian Multiculturalism Act and raise questions about Toronto's history with hate crimes and its multicultural status. In this paper, I explore the dynamics of Toronto's Hate Crimes from 2018 to 2023, before the current uptick. In particular, I describe how the types of hate crimes, the types of victims, and the quantity of victims have changed over time.

The rest of the paper is split into three main parts @sec-data, @sec-discussion, and @sec-limitations. The @sec-data section describes how the data is generated in the @sec-measurement section. It then moves to the @sec-cleaningandpackages which describes the data cleaning process and libraries used. The @sec-observations section demonstrates what a typical observation in the data set looks like, and the @sec-plotsandanalysis section displays the data to describe how it has varied over time and group.

```{r}

```

# Data {#sec-data}

## Measurement {#sec-measurement}

To run my analysis, data was collected from Open Data Toronto's Open Data Portal, through the R library opendatatoronto [@opendatatoronto]. The data source used is their Hate Crimes Open Data data set [@open-data-set]. This data of about 1400 observations has every crime that has been classified as a 'hate crime' by Toronto Police from the beginning of 2018 to the end of 2023. The data is generated as follows: a crime is committed in Toronto, and generally within a month that crime is reported by the victim. If a hate-motivated offence is suspected, the investigation is then led by a divisional investigator of the Hate Crime Unit (HCU) or by the HCU itself (Toronto Police Service). If hate-motivated offences are found, then this case will be added next year to the data set. Details of the crime are documented – including what social group they were biased against – these bias variables include ethnicity, race, gender, age, language, religion, and sexual orientation. Date and time (of both the crime and the reporting of it), offence committed, neighborhood, and place (such as apartments, malls, parks) were also recorded. Every unique case number was also attributed to each observation in the data set. There were almost no empty observations, except for a few cases where place data was missing. @cleaning-packages discusses this missing data further.

## Cleaning and Packages {#sec-cleaning-and-packages}

To download, clean, and analyze the data, the statistical software R was used [@citeR]. Other packages such as lubridate [@lubridate], tidyverse [@tidyverse], dplyr [@dplyr], janitor [@janitor] aided in this process. In the data cleaning process, about 30 missing observations were found. These 30 observations were all under the variable of location type, demonstrating the report writer had a hard time describing the location of the incident. To deal with this, all the location was set to unspecified which can still be interpreted in the graphs.

## Observations

A sample observation of the cleaned data is shown in Table 1. This table plots the variables of interest for our analysis. It can be seen that most observations are generally not biased to more than one group. Also, due to the categorical nature of the data, this is the best 'summary statistic' that can be shown, although other displays of the data that show all observations are plotted in the @sec-data-analysis section. This shows us that every variable of interest is documented rather nicely for analysis.

```{r}
#| label: random-sample-table-1
#| echo: false

# Set the seed for reproducibility
set.seed(31459)

# Table 1: Display the first set of variables
random_sample_table_1 <- hate_crime_analysis_data %>%
  select(occurrence_date, location_type, hood_158, race_bias, ethnicity_bias) %>%
  sample_n(5)

# Display the first table
knitr::kable(random_sample_table_1, 
             caption = "Table 1: Random Sample of 5 Hate Crime Observations - Part 1", 
             col.names = c("Occurrence Date", "Location Type", "Hood 158", "Race Bias", "Ethnicity Bias"))
```

```{r}
#| label: random-sample-table-2
#| echo: false

#Use the same seed to ensure these are the same observations.
set.seed(31459)

# Table 2: Display the second set of variables
random_sample_table_2 <- hate_crime_analysis_data %>%
  select(language_bias, religion_bias, sexual_orientation_bias, primary_offence, multiple_bias) %>%
  sample_n(5)  # The same random observations will be selected due to the seed

# Display the second table
knitr::kable(random_sample_table_2, 
             caption = "Table 1: Random Sample of 5 Hate Crime Observations - Part 2", 
             col.names = c("Language Bias", "Religion Bias", "Sexual Orientation Bias", "Primary Offence", "Multiple Bias"))

```

## Data Analysis and Plots {#sec-data-analysis}

documents the evolution of hate crimes in Toronto over time. It plots the monthly quantity of hate crimes committed for all months from January 2018 to December 2023.It also plots the 12 month moving average the demonstrate the trend over time. As seen, number of hate crimes go from averaging 12 a month in a given year, to nearly 30 by the end of the dataset. The catalyst for this upward trend seems to start during the early Covid-19 period in 2020, demonstrating that COVID-19 could be a possible explanatory factor this uptick. Interestingly, hate crimes still remained rather elevated post lockdown, and in 2023 climbed to even higher levels in comparison to the 2020 period. May 2023 had the highest amount of hate crimes committed in Toronto since the start of this data, with 44 being committed.

```{r}
#| label: fig-1
#| echo: false
#| fig.align: center

# Extract year and month from the 'occurrence_date' column
hate_crime_analysis_data <- hate_crime_analysis_data %>%
  mutate(year_month = floor_date(occurrence_date, "month"))

# Group by year and month, then count observations
monthly_counts <- hate_crime_analysis_data %>%
  group_by(year_month) %>%
  summarise(count = n())

# Calculate a 12-month (yearly) moving average
monthly_counts <- monthly_counts %>%
  mutate(moving_avg = rollmean(count, 12, fill = NA, align = "right"))

# Reshape the data for easier plotting of multiple lines
monthly_counts_long <- monthly_counts %>%
  pivot_longer(cols = c(count, moving_avg), 
               names_to = "Line_Type", 
               values_to = "Value")

# Plot with legend for monthly total and moving average
ggplot() +
  geom_line(data = monthly_counts_long, aes(x = year_month, y = Value, color = Line_Type, linetype = Line_Type), linewidth = 1) +  # Line plot for both trends
  geom_point(data = monthly_counts, aes(x = year_month, y = count), color = "black") +  # Points for monthly totals
  scale_color_manual(values = c("count" = "black", "moving_avg" = "blue"), 
                     labels = c("Monthly Total", "12 Month Moving Average")) +  # Define colors for the lines and set legend labels
  scale_linetype_manual(values = c("count" = "solid", "moving_avg" = "dashed"), 
                        labels = c("Monthly Total", "12 Month Moving Average")) +  # Define line types and set legend labels
  labs(
    title = "Number of Hate Crimes Per Month in Toronto",
    x = "Month",
    y = "Reported Hate Crimes",
    color = "Legend",
    linetype = "Legend",
    caption = "Figure 1: Monthly Hate Crime Counts from 2018 to 2024"
  ) +
  theme_minimal() +
  scale_x_date(date_labels = "%b %Y", date_breaks = "3 months") + 
  theme(
    axis.text.x = element_text(angle = 90, hjust = 1),
    plot.caption = element_text(hjust = 0.5)  # Center the caption
  )

```

Figure 2 plots the number of people targeted for each crime bias type. It can be seen that most hate crimes target a specific characteristic of an individual, the most common of which are religion and race. The least common biases were age bias and language bias, where age bias didn't have a single observation and language likely only had one. Here we also see the same trend outlined in Figure 1, that is, hate crimes increased in 2020, and have remained at high levels since, and in 2023 have seen even more increases. This increase in 2023 is generally fueled by increases in hate crime against religion, where as the increase in 2020 and 2021 are generally fueled by race. This suggests that the reasons for the increases in the hate crimes are possibly different.

```{r}
#| label: fig-2
#| fig-cap: Groups targetted by hate crime.
#| echo: false

# Step 1: Filter and reshape the data to long format for non-multiple bias
long_data <- hate_crime_analysis_data %>%
  filter(multiple_bias == "NO") %>%  # Exclude entries with multiple bias
  select(occurrence_date, race_bias, ethnicity_bias, religion_bias, language_bias, age_bias, sexual_orientation_bias) %>%
  pivot_longer(cols = c(race_bias, ethnicity_bias, religion_bias, language_bias, age_bias, sexual_orientation_bias), 
               names_to = "bias_type", 
               values_to = "bias_value") %>%
  filter(bias_value != "None" & bias_value != "NO")  # Exclude entries with "None" or NA

# Step 2: Modify bias_type to just represent the category
long_data <- long_data %>%
  mutate(bias_type = case_when(
    bias_type == "race_bias" ~ "Race Bias",
    bias_type == "ethnicity_bias" ~ "Ethnicity Bias",
    bias_type == "religion_bias" ~ "Religion Bias",
    bias_type == "language_bias" ~ "Language Bias",
    bias_type == "age_bias" ~ "Age Bias",
    bias_type == "sexual_orientation_bias" ~ "Sexual Orientation Bias",
    TRUE ~ bias_type  # Fallback case, should not be reached
  ))

# Step 3: Count hate crimes by year and bias type for non-multiple bias
hate_crime_counts <- long_data %>%
  mutate(year = year(occurrence_date)) %>%  # Extract year
  group_by(year, bias_type) %>%             # Group by year and bias type
  summarise(count = n(), .groups = "drop")  # Count entries

# Step 4: Count hate crimes where multiple_bias is TRUE
multiple_bias_counts <- hate_crime_analysis_data %>%
  filter(multiple_bias == "YES") %>%
  mutate(year = year(occurrence_date)) %>%
  group_by(year) %>%
  summarise(count = n(), bias_type = "Multiple Bias", .groups = "drop")  # Count entries for multiple bias

# Step 5: Combine the data for the final chart
final_counts <- bind_rows(hate_crime_counts, multiple_bias_counts)

# Step 6: Create the segmented bar chart
ggplot(final_counts, aes(x = factor(year), y = count, fill = bias_type)) +
  geom_bar(stat = "identity", position = "stack") +  # Use 'identity' for raw counts
  labs(title = "Hate Crimes by Bias Type and Year",
       x = "Year",
       y = "Total Number of Hate Crimes",
       fill = "Bias Type") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1") +  # Optional: Set color palette
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis text for better readability
```

@fig-3a provides the year breakdown of race-motivated hate crimes. As seen, Black people are clearly the most targeted group for hate crimes in Toronto. They made up the largest proportion of hate crime victims in every single year, and were almost the only victims of race targeted hate crimes in 2018. Another significant subgroup were East/Southeast Asians. They are particularly notable in 2021 onward, suggesting that COVID may have played a role in East/Southeast Asians becoming victims of hate crimes; this particularly makes sense given the rhetoric at the time.

```{r}
#| label: fig-3a
#| fig-cap: Yearly Breakdown of Race-Motivated Hate Crimes
#| echo: false

ggplot(hate_crime_analysis_data %>% filter(race_bias != "None"), aes(x = factor(year(occurrence_date)), fill = race_bias)) +
  geom_bar(position = "stack") +  # Stack the bars to show total counts by year
  labs(
    title = "Hate Crimes by Race and Year",
    x = "Year",
    y = "Total Hate Crimes",
    fill = "Race Bias"
  ) +
  theme_minimal()

```

@fig-3b provides the year breakdown of religion motivated hate crimes

```{r}
#| label: fig-b
#| fig-cap: Yearly Breakdown of Religion-Motivated Hate Crimes
#| echo: false

ggplot(hate_crime_analysis_data %>% filter(religion_bias != "None"), aes(x = factor(year(occurrence_date)), fill = religion_bias)) +
  geom_bar(position = "stack") +  # Stack the bars to show total counts by year
  labs(
    title = "Hate Crimes by Religion and Year",
    x = "Year",
    y = "Total Hate Crimes",
    fill = "Religion Bias"
  ) +
  theme_minimal()

```

# Discussion {#sec-discussion}

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this.

## Second discussion point

## Third discussion point

## Limitations

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {.unnumbered}

```{r}

```

## Diagnostics

```{r}

```

\newpage

# References
